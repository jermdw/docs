



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="netSEC Ninjas Dojo">
      
      
        <link rel="canonical" href="https://j3rmbadger.com/docs/malware/">
      
      
        <meta name="author" content="Master Splinter">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0, mkdocs-material-3.0.3">
    
    
      
        <title>Malware Analysis - j3rmdocs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue-grey">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#malware-analysis" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://j3rmbadger.com/docs" title="j3rmdocs" class="md-header-nav__button md-logo">
          
            <img src="../images/icons/ninja-symbol_white.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                j3rmdocs
              </span>
              <span class="md-header-nav__topic">
                Malware Analysis
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com.com/jermdw/docs" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      jermdw/docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="Home" class="md-tabs__link md-tabs__link--active">
        Home
      </a>
    
  </li>

      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../cheat/linux/" title="Cheatsheets" class="md-tabs__link">
          Cheatsheets
        </a>
      
    </li>
  

      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://j3rmbadger.com/docs" title="j3rmdocs" class="md-nav__button md-logo">
      
        <img src="../images/icons/ninja-symbol_white.svg" width="48" height="48">
      
    </a>
    j3rmdocs
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com.com/jermdw/docs" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      jermdw/docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Malware Analysis
      </label>
    
    <a href="./" title="Malware Analysis" class="md-nav__link md-nav__link--active">
      Malware Analysis
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#toolkit" title="Toolkit" class="md-nav__link">
    Toolkit
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#portable-executable-inspection" title="Portable Executable Inspection" class="md-nav__link">
    Portable Executable Inspection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugger" title="Debugger" class="md-nav__link">
    Debugger
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-techniques" title="Analysis Techniques" class="md-nav__link">
    Analysis Techniques
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#static-analysis" title="Static Analysis" class="md-nav__link">
    Static Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis" title="Dynamic Analysis" class="md-nav__link">
    Dynamic Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-static-analysis" title="Basic Static Analysis" class="md-nav__link">
    Basic Static Analysis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#finding-strings" title="Finding Strings" class="md-nav__link">
    Finding Strings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packed-obfuscated-malware" title="Packed / Obfuscated Malware" class="md-nav__link">
    Packed / Obfuscated Malware
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#portable-executable-file-format" title="Portable Executable File Format" class="md-nav__link">
    Portable Executable File Format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linked-libraries-functions" title="Linked Libraries &amp; Functions" class="md-nav__link">
    Linked Libraries &amp; Functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#static-runtime-and-dynamic-linking" title="Static, Runtime, and Dynamic Linking" class="md-nav__link">
    Static, Runtime, and Dynamic Linking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamically-linked-functions" title="Dynamically Linked Functions" class="md-nav__link">
    Dynamically Linked Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-dlls" title="Common DLLs" class="md-nav__link">
    Common DLLs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imported-functions" title="Imported Functions" class="md-nav__link">
    Imported Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exported-functions" title="Exported Functions" class="md-nav__link">
    Exported Functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-pe-file-headers-and-sections" title="The PE File Headers and Sections" class="md-nav__link">
    The PE File Headers and Sections
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#table-1-4-sections-of-a-pe-file-for-a-windows-executable" title="Table 1-4. Sections of a PE File for a Windows Executable" class="md-nav__link">
    Table 1-4. Sections of a PE File for a Windows Executable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis-in-practice" title="Static Analysis in Practice" class="md-nav__link">
    Static Analysis in Practice
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Cheatsheets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Cheatsheets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cheat/linux/" title="Linux" class="md-nav__link">
      Linux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cheat/nmap/" title="NMAP" class="md-nav__link">
      NMAP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cheat/pwsh/" title="Powershell" class="md-nav__link">
      Powershell
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../lablocal/" title="Lab.Local" class="md-nav__link">
      Lab.Local
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../scripts/" title="Scripts" class="md-nav__link">
      Scripts
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#toolkit" title="Toolkit" class="md-nav__link">
    Toolkit
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#portable-executable-inspection" title="Portable Executable Inspection" class="md-nav__link">
    Portable Executable Inspection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugger" title="Debugger" class="md-nav__link">
    Debugger
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-techniques" title="Analysis Techniques" class="md-nav__link">
    Analysis Techniques
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#static-analysis" title="Static Analysis" class="md-nav__link">
    Static Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis" title="Dynamic Analysis" class="md-nav__link">
    Dynamic Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-static-analysis" title="Basic Static Analysis" class="md-nav__link">
    Basic Static Analysis
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#finding-strings" title="Finding Strings" class="md-nav__link">
    Finding Strings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packed-obfuscated-malware" title="Packed / Obfuscated Malware" class="md-nav__link">
    Packed / Obfuscated Malware
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#portable-executable-file-format" title="Portable Executable File Format" class="md-nav__link">
    Portable Executable File Format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linked-libraries-functions" title="Linked Libraries &amp; Functions" class="md-nav__link">
    Linked Libraries &amp; Functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#static-runtime-and-dynamic-linking" title="Static, Runtime, and Dynamic Linking" class="md-nav__link">
    Static, Runtime, and Dynamic Linking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamically-linked-functions" title="Dynamically Linked Functions" class="md-nav__link">
    Dynamically Linked Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-dlls" title="Common DLLs" class="md-nav__link">
    Common DLLs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imported-functions" title="Imported Functions" class="md-nav__link">
    Imported Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exported-functions" title="Exported Functions" class="md-nav__link">
    Exported Functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-pe-file-headers-and-sections" title="The PE File Headers and Sections" class="md-nav__link">
    The PE File Headers and Sections
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#table-1-4-sections-of-a-pe-file-for-a-windows-executable" title="Table 1-4. Sections of a PE File for a Windows Executable" class="md-nav__link">
    Table 1-4. Sections of a PE File for a Windows Executable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis-in-practice" title="Static Analysis in Practice" class="md-nav__link">
    Static Analysis in Practice
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="malware-analysis">Malware Analysis<a class="headerlink" href="#malware-analysis" title="Permanent link">&para;</a></h1>
<h2 id="toolkit">Toolkit<a class="headerlink" href="#toolkit" title="Permanent link">&para;</a></h2>
<h3 id="portable-executable-inspection">Portable Executable Inspection<a class="headerlink" href="#portable-executable-inspection" title="Permanent link">&para;</a></h3>
<h3 id="debugger">Debugger<a class="headerlink" href="#debugger" title="Permanent link">&para;</a></h3>
<h2 id="analysis-techniques">Analysis Techniques<a class="headerlink" href="#analysis-techniques" title="Permanent link">&para;</a></h2>
<h3 id="static-analysis">Static Analysis<a class="headerlink" href="#static-analysis" title="Permanent link">&para;</a></h3>
<ul>
<li>Examination of the executable file without viewing the actual instructions. </li>
<li>Basic static analysis can confirm whether a file is malicious, provide information about its functionality.</li>
<li><strong>Advantages:</strong> straightforward and quick. </li>
<li><strong>Disadvantages:</strong> ineffective against complex malware, unable to determine malware's behaviorial characteristics.</li>
</ul>
<h3 id="dynamic-analysis">Dynamic Analysis<a class="headerlink" href="#dynamic-analysis" title="Permanent link">&para;</a></h3>
<ul>
<li>Runtime analysis of malware. Involves running the malware and observing its behavior.</li>
<li><strong>Advantage</strong>: can provide thorough understanding of malware behavior.</li>
<li><strong>Disadvantage:</strong> can be time consuming and requires additional setup to ensure safety.</li>
</ul>
<h2 id="basic-static-analysis">Basic Static Analysis<a class="headerlink" href="#basic-static-analysis" title="Permanent link">&para;</a></h2>
<h3 id="finding-strings">Finding Strings<a class="headerlink" href="#finding-strings" title="Permanent link">&para;</a></h3>
<p>The <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/strings">strings</a> program searches an executable for strings, which are typically stored in either ASCII or Unicode format.</p>
<p>Both ASCII and Unicode formats store characters in sequences that end with a NULL terminator to indicate that the string is complete. ASCII strings use 1 byte per character, and Unicode uses 2 bytes per character.</p>
<ul>
<li><a href="https://github.com/glmcdona/strings2">strings2</a></li>
</ul>
<h3 id="packed-obfuscated-malware">Packed / Obfuscated Malware<a class="headerlink" href="#packed-obfuscated-malware" title="Permanent link">&para;</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Packed and obfuscated code will often include at least the functions <code>LoadLibrary</code> and <code>GetProcAddress</code>, which are used to load and gain access to additional functions.</p>
</div>
<p><a href="https://upx.github.io">UPX</a>
<a href="https://www.aldeid.com/wiki/PEiD">PEid</a></p>
<h3 id="portable-executable-file-format">Portable Executable File Format<a class="headerlink" href="#portable-executable-file-format" title="Permanent link">&para;</a></h3>
<p>The Portable Executable (PE) file format is used by Windows executables, object code, and DLLs. The PE file format is a data structure that contains the information necessary for the Windows OS loader to manage the wrapped executable code. Nearly every file with executable code that is loaded by Windows is in the PE file format, though some legacy file formats do appear on rare occasion in malware.</p>
<p>PE files begin with a header that includes information about the code, the type of application, required library functions, and space requirements. The information in the PE header is of great value to the malware analyst.</p>
<h3 id="linked-libraries-functions">Linked Libraries &amp; Functions<a class="headerlink" href="#linked-libraries-functions" title="Permanent link">&para;</a></h3>
<h4 id="static-runtime-and-dynamic-linking">Static, Runtime, and Dynamic Linking<a class="headerlink" href="#static-runtime-and-dynamic-linking" title="Permanent link">&para;</a></h4>
<h4 id="dynamically-linked-functions">Dynamically Linked Functions<a class="headerlink" href="#dynamically-linked-functions" title="Permanent link">&para;</a></h4>
<p><a href="http://www.dependencywalker.com">Dependency Walker</a></p>
<h4 id="common-dlls">Common DLLs<a class="headerlink" href="#common-dlls" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th align="center">DLL</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Kernel32.dll</td>
<td align="center">This is a very common DLL that contains core functionality, such as access and manipulation of memory, files, and hardware.</td>
</tr>
<tr>
<td align="center">Advapi32.dll</td>
<td align="center">This DLL provides access to advanced core Windows components such as the Service Manager and Registry.</td>
</tr>
<tr>
<td align="center">User32.dll</td>
<td align="center">This DLL contains all the user-interface components, such as buttons, scroll bars, and components for controlling and responding to user actions.</td>
</tr>
<tr>
<td align="center">Gdi32.dll</td>
<td align="center">This DLL contains functions for displaying and manipulating graphics.</td>
</tr>
<tr>
<td align="center">Ntdll.dll</td>
<td align="center">This DLL is the interface to the Windows kernel. Executables generally do not import this file directly, although it is always imported indirectly by Kernel32.dll. If an executable imports this file, it means that the author intended to use functionality not normally available to Windows programs. Some tasks, such as hiding functionality or manipulating processes, will use this interface.</td>
</tr>
<tr>
<td align="center">WSock32.dll, Ws2_32.dll</td>
<td align="center">These are networking DLLs. A program that accesses either of these most likely connects to a network or performs network-related tasks.</td>
</tr>
<tr>
<td align="center">Wininet.dll</td>
<td align="center">This DLL contains higher-level networking functions that implement protocols such as FTP, HTTP, and NTP.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">FUNCTION NAMING CONVENTIONS</p>
<p>When evaluating unfamiliar Windows functions, a few naming conventions are worth noting because they come up often and might confuse you if you don’t recognize them. For example, you will often encounter function names with an Ex suffix, such as CreateWindowEx. When Microsoft updates a function and the new function is incompatible with the old one, Microsoft continues to support the old function. The new function is given the same name as the old function, with an added Ex suffix. Functions that have been significantly updated twice have two Ex suffixes in their names.</p>
<p>Many functions that take strings as parameters include an A or a W at the end of their names, such as CreateDirectoryW. This letter does not appear in the documentation for the function; it simply indicates that the function accepts a string parameter and that there are two different versions of the function: one for ASCII strings and one for wide character strings. Remember to drop the trailing A or W when searching for the function in the Microsoft documentation.</p>
</div>
<h4 id="imported-functions">Imported Functions<a class="headerlink" href="#imported-functions" title="Permanent link">&para;</a></h4>
<p>The PE file header also includes information about specific functions used by an executable. The names of these Windows functions can give you a good idea about what the executable does. Microsoft does an excellent job of documenting the Windows API through the Microsoft Developer Network (MSDN) library. </p>
<h4 id="exported-functions">Exported Functions<a class="headerlink" href="#exported-functions" title="Permanent link">&para;</a></h4>
<p>In many cases, software authors name their exported functions in a way that provides useful information. One common convention is to use the name used in the Microsoft documentation. For example, in order to run a program as a service, you must first define a ServiceMain function. The presence of an exported function called ServiceMain tells you that the malware runs as part of a service.</p>
<p>Unfortunately, while the Microsoft documentation calls this function ServiceMain, and it’s common for programmers to do the same, the function can have any name. Therefore, the names of exported functions are actually of limited use against sophisticated malware. If malware uses exports, it will often either omit names entirely or use unclear or misleading names.</p>
<h3 id="the-pe-file-headers-and-sections">The PE File Headers and Sections<a class="headerlink" href="#the-pe-file-headers-and-sections" title="Permanent link">&para;</a></h3>
<p>PE file headers can provide considerably more information than just imports. The PE file format contains a header followed by a series of sections. The header contains metadata about the file itself. Following the header are the actual sections of the file, each of which contains useful information. As we progress through the book, we will continue to discuss strategies for viewing the information in each of these sections. The following are the most common and interesting sections in a PE file:</p>
<p>.text. The .text section contains the instructions that the CPU executes. All other sections store data and supporting information. Generally, this is the only section that can execute, and it should be the only section that includes code.</p>
<p>.rdata. The .rdata section typically contains the import and export information, which is the same information available from both Dependency Walker and PEview. This section can also store other read-only data used by the program. Sometimes a file will contain an .idata and .edata section, which store the import and export information (see Table 1-4).</p>
<p>.data. The .data section contains the program’s global data, which is accessible from anywhere in the program. Local data is not stored in this section, or anywhere else in the PE file. (We address this topic in Chapter 6.)</p>
<p>.rsrc. The .rsrc section includes the resources used by the executable that are not considered part of the executable, such as icons, images, menus, and strings. Strings can be stored either in the .rsrc section or in the main program, but they are often stored in the .rsrc section for multilanguage support.</p>
<p>Section names are often consistent across a compiler, but can vary across different compilers. For example, Visual Studio uses .text for executable code, but Borland Delphi uses CODE. Windows doesn’t care about the actual name since it uses other information in the PE header to determine how a section is used. Furthermore, the section names are sometimes obfuscated to make analysis more difficult. Luckily, the default names are used most of the time. Table 1-4 lists the most common you’ll encounter.</p>
<h4 id="table-1-4-sections-of-a-pe-file-for-a-windows-executable">Table 1-4. Sections of a PE File for a Windows Executable<a class="headerlink" href="#table-1-4-sections-of-a-pe-file-for-a-windows-executable" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th align="center">Executable</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">.text</td>
<td align="center">Contains the executable code</td>
</tr>
<tr>
<td align="center">.rdata</td>
<td align="center">Holds read-only data that is globally accessible within the program</td>
</tr>
<tr>
<td align="center">.data</td>
<td align="center">Stores global data accessed throughout the program</td>
</tr>
<tr>
<td align="center">.idata</td>
<td align="center">Sometimes present and stores the import function information; if this section is not present, the import function information is stored in the .rdata section</td>
</tr>
<tr>
<td align="center">.edata</td>
<td align="center">Sometimes present and stores the export function information; if this section is not present, the export function information is stored in the .rdata section</td>
</tr>
<tr>
<td align="center">.pdata</td>
<td align="center">Present only in 64-bit executables and stores exception-handling information</td>
</tr>
<tr>
<td align="center">.rsrc</td>
<td align="center">Stores resources needed by the executable</td>
</tr>
<tr>
<td align="center">.reloc</td>
<td align="center">Contains information for relocation of library files</td>
</tr>
</tbody>
</table>
<h3 id="static-analysis-in-practice">Static Analysis in Practice<a class="headerlink" href="#static-analysis-in-practice" title="Permanent link">&para;</a></h3>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../cheat/linux/" title="Linux" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Linux
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 SplinterCo
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>